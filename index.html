<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Profesional de Correcciones y Observaciones</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2d3748;
            --accent: #3182ce;
            --success: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --light: #f7fafc;
            --dark: #2d3748;
            --gray: #718096;
            --light-gray: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 10px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f6f8fc 0%, #edf2f7 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-gray);
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .logo-text h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }

        .logo-text p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--gray);
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--accent);
        }

        .action-btn {
            width: 100%;
            padding: 14px;
            margin-bottom: 12px;
            border: none;
            border-radius: 8px;
            background: var(--light);
            color: var(--dark);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .action-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateX(5px);
        }

        .action-btn.primary {
            background: var(--accent);
            color: white;
        }

        .action-btn.primary:hover {
            background: var(--primary);
        }

        /* Filters */
        .filters {
            margin-top: 30px;
        }

        .filter-group {
            margin-bottom: 20px;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
        }

        select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            background: white;
            color: var(--dark);
            font-size: 0.95rem;
            transition: var(--transition);
        }

        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        /* Header */
        .header {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .header-title p {
            color: var(--gray);
            font-size: 0.95rem;
        }

        .date-display {
            background: var(--light);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            color: var(--primary);
        }

        /* Form Card */
        .form-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            transition: var(--transition);
        }

        .form-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .form-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-gray);
        }

        .form-header i {
            color: var(--accent);
            font-size: 1.5rem;
        }

        .form-header h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: span 2;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
            font-size: 0.95rem;
        }

        input, textarea, select {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: white;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        /* Priority Selector */
        .priority-selector {
            display: flex;
            gap: 10px;
        }

        .priority-option {
            flex: 1;
            text-align: center;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .priority-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: currentColor;
            opacity: 0;
            transition: var(--transition);
        }

        .priority-option:hover::before {
            opacity: 1;
        }

        .priority-option.selected::before {
            opacity: 1;
        }

        .priority-option.low { color: var(--success); border-color: var(--success); }
        .priority-option.medium { color: var(--warning); border-color: var(--warning); }
        .priority-option.high { color: var(--danger); border-color: var(--danger); }

        .priority-option.low.selected { background: rgba(56, 161, 105, 0.1); }
        .priority-option.medium.selected { background: rgba(214, 158, 46, 0.1); }
        .priority-option.high.selected { background: rgba(229, 62, 62, 0.1); }

        /* Status Selector */
        .status-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .status-option {
            padding: 10px 20px;
            border: 2px solid var(--light-gray);
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .status-option:hover {
            transform: translateY(-2px);
        }

        .status-option.selected {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
        }

        /* Buttons */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(49, 130, 206, 0.3);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 2px solid var(--light-gray);
        }

        .btn-secondary:hover {
            background: var(--light-gray);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--light-gray);
        }

        /* Observations Container */
        .observations-container {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
        }

        .observations-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .observations-header h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
        }

        /* Observations Grid */
        .observations-grid {
            display: grid;
            gap: 20px;
        }

        .observation-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--accent);
            padding: 25px;
            transition: var(--transition);
            position: relative;
        }

        .observation-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .observation-card.high { border-left-color: var(--danger); }
        .observation-card.medium { border-left-color: var(--warning); }
        .observation-card.low { border-left-color: var(--success); }

        .observation-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .observation-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .observation-document {
            color: var(--accent);
            font-weight: 500;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .observation-document i {
            font-size: 0.9rem;
        }

        .observation-priority {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-high { background: rgba(229, 62, 62, 0.1); color: var(--danger); }
        .priority-medium { background: rgba(214, 158, 46, 0.1); color: var(--warning); }
        .priority-low { background: rgba(56, 161, 105, 0.1); color: var(--success); }

        .observation-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
            font-size: 0.9rem;
            color: var(--gray);
        }

        .observation-date {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .observation-status {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-pending { background: rgba(214, 158, 46, 0.1); color: var(--warning); }
        .status-in-progress { background: rgba(49, 130, 206, 0.1); color: var(--accent); }
        .status-completed { background: rgba(56, 161, 105, 0.1); color: var(--success); }
        .status-cancelled { background: rgba(113, 128, 150, 0.1); color: var(--gray); }

        .observation-actions {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            opacity: 0;
            transition: var(--transition);
        }

        .observation-card:hover .observation-actions {
            opacity: 1;
        }

        .action-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light);
            color: var(--dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .action-icon:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        .observation-content {
            color: var(--secondary);
            line-height: 1.6;
            margin-top: 15px;
        }

        .observation-reference {
            margin-top: 15px;
            padding: 10px 15px;
            background: var(--light);
            border-radius: 6px;
            border-left: 3px solid var(--accent);
        }

        .reference-label {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--light-gray);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--gray);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 2px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .close-modal {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light);
            color: var(--dark);
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }

        .close-modal:hover {
            background: var(--danger);
            color: white;
        }

        .modal-body {
            padding: 30px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-group.full-width {
                grid-column: span 1;
            }
            
            .observations-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .search-box {
                width: 100%;
            }
            
            .form-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .priority-selector {
                flex-direction: column;
            }
            
            .stat-card {
                padding: 15px;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .observation-card {
            animation: fadeIn 0.3s ease-out;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(150%);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 2000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .notification.success .notification-icon { background: var(--success); }
        .notification.error .notification-icon { background: var(--danger); }
        .notification.info .notification-icon { background: var(--accent); }

        .notification-content h4 {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .notification-content p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Export Options */
        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .export-option {
            padding: 20px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .export-option:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .export-option i {
            font-size: 2rem;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .export-option h4 {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .export-option p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Summary Table in PDF */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .summary-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .summary-table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--light-gray);
        }

        .summary-table tr:nth-child(even) {
            background: var(--light);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="logo-text">
                    <h1>Correcciones PRO</h1>
                    <p>Sistema profesional de registro</p>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-observations">0</div>
                    <div class="stat-label">Observaciones</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pending-count">0</div>
                    <div class="stat-label">Pendientes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="high-priority-count">0</div>
                    <div class="stat-label">Alta Prioridad</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="documents-count">0</div>
                    <div class="stat-label">Documentos</div>
                </div>
            </div>

            <div class="quick-actions">
                <h3 class="section-title"><i class="fas fa-bolt"></i> Acciones Rápidas</h3>
                <button class="action-btn primary" id="new-observation-btn">
                    <i class="fas fa-plus"></i> Nueva Observación
                </button>
                <button class="action-btn" id="export-pdf-btn">
                    <i class="fas fa-file-pdf"></i> Generar Reporte
                </button>
                <button class="action-btn" id="view-all-btn">
                    <i class="fas fa-list"></i> Ver Todas
                </button>
                <button class="action-btn" id="clear-completed-btn">
                    <i class="fas fa-check-double"></i> Limpiar Completadas
                </button>
            </div>

            <div class="filters">
                <h3 class="section-title"><i class="fas fa-filter"></i> Filtros</h3>
                <div class="filter-group">
                    <label class="filter-label">Prioridad</label>
                    <select id="filter-priority">
                        <option value="all">Todas las prioridades</option>
                        <option value="high">Alta Prioridad</option>
                        <option value="medium">Prioridad Media</option>
                        <option value="low">Baja Prioridad</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Estado</label>
                    <select id="filter-status">
                        <option value="all">Todos los estados</option>
                        <option value="pending">Pendiente</option>
                        <option value="in-progress">En Progreso</option>
                        <option value="completed">Completado</option>
                        <option value="cancelled">Cancelado</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Documento</label>
                    <select id="filter-document">
                        <option value="all">Todos los documentos</option>
                    </select>
                </div>
            </div>

            <div class="backup-info" style="margin-top: 30px; padding-top: 20px; border-top: 2px solid var(--light-gray);">
                <p style="font-size: 0.85rem; color: var(--gray); text-align: center;">
                    <i class="fas fa-database"></i> Datos almacenados localmente
                </p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-title">
                    <h2 id="page-title">Registro de Correcciones</h2>
                    <p>Gestión profesional de observaciones técnicas</p>
                </div>
                <div class="date-display">
                    <i class="far fa-calendar"></i>
                    <span id="current-date"></span>
                </div>
            </div>

            <!-- Formulario de Observación -->
            <div class="form-card" id="observation-form">
                <div class="form-header">
                    <i class="fas fa-edit"></i>
                    <h3>Nueva Observación / Corrección</h3>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="document-name"><i class="fas fa-file-alt"></i> Nombre del Documento</label>
                        <input type="text" id="document-name" placeholder="Ej. TISUR-1502-042-DWG-00001_B" required>
                    </div>

                    <div class="form-group">
                        <label for="observation-title"><i class="fas fa-heading"></i> Título de la Observación</label>
                        <input type="text" id="observation-title" placeholder="Ej. Corrección del NÚMERO DE PLANO PROVEEDOR" required>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-exclamation-circle"></i> Prioridad</label>
                        <div class="priority-selector">
                            <div class="priority-option low" data-priority="low">
                                Baja
                            </div>
                            <div class="priority-option medium selected" data-priority="medium">
                                Media
                            </div>
                            <div class="priority-option high" data-priority="high">
                                Alta
                            </div>
                        </div>
                        <input type="hidden" id="priority" value="medium">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-tasks"></i> Estado</label>
                        <div class="status-selector">
                            <div class="status-option selected" data-status="pending">Pendiente</div>
                            <div class="status-option" data-status="in-progress">En Progreso</div>
                            <div class="status-option" data-status="completed">Completado</div>
                            <div class="status-option" data-status="cancelled">Cancelado</div>
                        </div>
                        <input type="hidden" id="status" value="pending">
                    </div>

                    <div class="form-group full-width">
                        <label for="observation-details"><i class="fas fa-align-left"></i> Descripción Detallada</label>
                        <textarea id="observation-details" placeholder="Describe detalladamente la observación. Usa viñetas para organizar la información:
• Primer punto
• Segundo punto
• Cambios realizados" rows="4" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="observation-reference"><i class="fas fa-hashtag"></i> Referencia (Número)</label>
                        <input type="text" id="observation-reference" placeholder="Ej. 1, 2, 3...">
                    </div>

                    <div class="form-group">
                        <label for="observation-category"><i class="fas fa-tag"></i> Categoría</label>
                        <select id="observation-category">
                            <option value="plano">Plano</option>
                            <option value="memoria">Memoria de Cálculo</option>
                            <option value="especificacion">Especificación Técnica</option>
                            <option value="documentacion">Documentación General</option>
                            <option value="normativa">Normativa</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="clear-form-btn">
                        <i class="fas fa-times"></i> Limpiar
                    </button>
                    <button type="submit" class="btn btn-primary" id="save-observation-btn">
                        <i class="fas fa-save"></i> Guardar Observación
                    </button>
                </div>
            </div>

            <!-- Lista de Observaciones -->
            <div class="observations-container">
                <div class="observations-header">
                    <h3>Observaciones Registradas</h3>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-observations" placeholder="Buscar observaciones...">
                    </div>
                </div>

                <div class="observations-grid" id="observations-list">
                    <!-- Las observaciones se cargarán aquí dinámicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Exportación -->
    <div class="modal" id="export-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-export"></i> Exportar Reporte</h3>
                <button class="close-modal" id="close-export-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: var(--gray);">Selecciona el formato para exportar tu registro de observaciones.</p>
                
                <div class="export-options">
                    <div class="export-option" data-format="pdf-detailed">
                        <i class="fas fa-file-pdf"></i>
                        <h4>PDF Detallado</h4>
                        <p>Reporte completo con formato profesional</p>
                    </div>
                    <div class="export-option" data-format="pdf-summary">
                        <i class="fas fa-file-contract"></i>
                        <h4>PDF Resumen</h4>
                        <p>Tabla resumen y lista de observaciones</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-check"></i>
        </div>
        <div class="notification-content">
            <h4 id="notification-title">Éxito</h4>
            <p id="notification-message">Operación realizada correctamente</p>
        </div>
    </div>

    <script>
        // Variables globales
        let observations = [];
        let editingId = null;
        let currentFilter = {
            priority: 'all',
            status: 'all',
            document: 'all',
            search: ''
        };

        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadObservations();
            updateUI();
            
            // Agregar observación de ejemplo
            addExampleObservation();
        });

        function initializeApp() {
            // Establecer fecha actual
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('current-date').textContent = 
                now.toLocaleDateString('es-ES', options);
        }

        function addExampleObservation() {
            // Solo agregar ejemplo si no hay observaciones
            if (observations.length > 0) return;
            
            const exampleObservation = {
                id: Date.now(),
                document: "TISUR-1502-042-DWG-00001_B",
                title: "Corrección del NÚMERO DE PLANO PROVEEDOR",
                priority: "medium",
                status: "completed",
                details: "Se modificó el numero de plano del proveedor de \"006CIV24-1502-042-DWG-00003\" a \"006CIV24-1502-042-DWG-00001\"",
                reference: "1",
                category: "plano",
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                formattedDate: formatDate(new Date())
            };
            
            observations.push(exampleObservation);
            saveObservations();
            updateUI();
            filterObservations();
        }

        function setupEventListeners() {
            // Formulario
            document.getElementById('save-observation-btn').addEventListener('click', saveObservation);
            document.getElementById('clear-form-btn').addEventListener('click', clearForm);
            
            // Prioridad
            document.querySelectorAll('.priority-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.priority-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('priority').value = this.dataset.priority;
                });
            });
            
            // Estado
            document.querySelectorAll('.status-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.status-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('status').value = this.dataset.status;
                });
            });
            
            // Botones de acción
            document.getElementById('new-observation-btn').addEventListener('click', () => {
                clearForm();
                scrollToForm();
            });
            
            document.getElementById('export-pdf-btn').addEventListener('click', () => {
                document.getElementById('export-modal').classList.add('active');
            });
            
            document.getElementById('view-all-btn').addEventListener('click', () => {
                resetFilters();
                filterObservations();
            });
            
            document.getElementById('clear-completed-btn').addEventListener('click', clearCompletedObservations);
            
            // Filtros
            document.getElementById('filter-priority').addEventListener('change', function() {
                currentFilter.priority = this.value;
                filterObservations();
            });
            
            document.getElementById('filter-status').addEventListener('change', function() {
                currentFilter.status = this.value;
                filterObservations();
            });
            
            document.getElementById('filter-document').addEventListener('change', function() {
                currentFilter.document = this.value;
                filterObservations();
            });
            
            document.getElementById('search-observations').addEventListener('input', function() {
                currentFilter.search = this.value.toLowerCase();
                filterObservations();
            });
            
            // Modal
            document.getElementById('close-export-modal').addEventListener('click', () => {
                document.getElementById('export-modal').classList.remove('active');
            });
            
            document.querySelectorAll('.export-option').forEach(option => {
                option.addEventListener('click', function() {
                    const format = this.dataset.format;
                    generateExport(format);
                });
            });
            
            // Cerrar modal al hacer clic fuera
            document.getElementById('export-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        }

        function saveObservation() {
            const documentName = document.getElementById('document-name').value.trim();
            const title = document.getElementById('observation-title').value.trim();
            const priority = document.getElementById('priority').value;
            const status = document.getElementById('status').value;
            const details = document.getElementById('observation-details').value.trim();
            const reference = document.getElementById('observation-reference').value.trim();
            const category = document.getElementById('observation-category').value;
            
            // Validación
            if (!documentName || !title || !details) {
                showNotification('Por favor complete todos los campos requeridos', 'error');
                return;
            }
            
            const observation = {
                id: editingId || Date.now(),
                document: documentName,
                title: title,
                priority: priority,
                status: status,
                details: details,
                reference: reference,
                category: category,
                createdAt: editingId ? observations.find(o => o.id === editingId).createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                formattedDate: formatDate(new Date())
            };
            
            if (editingId) {
                // Actualizar observación existente
                const index = observations.findIndex(o => o.id === editingId);
                observations[index] = observation;
                showNotification('Observación actualizada correctamente', 'success');
            } else {
                // Nueva observación
                observations.unshift(observation);
                showNotification('Observación guardada correctamente', 'success');
            }
            
            // Guardar en localStorage
            saveObservations();
            
            // Actualizar UI
            clearForm();
            updateUI();
            filterObservations();
        }

        function editObservation(id) {
            const observation = observations.find(o => o.id === id);
            if (!observation) return;
            
            editingId = id;
            
            // Llenar formulario
            document.getElementById('document-name').value = observation.document;
            document.getElementById('observation-title').value = observation.title;
            document.getElementById('priority').value = observation.priority;
            document.getElementById('status').value = observation.status;
            document.getElementById('observation-details').value = observation.details;
            document.getElementById('observation-reference').value = observation.reference || '';
            document.getElementById('observation-category').value = observation.category;
            
            // Actualizar selectores UI
            document.querySelectorAll('.priority-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.priority === observation.priority) {
                    o.classList.add('selected');
                }
            });
            
            document.querySelectorAll('.status-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.status === observation.status) {
                    o.classList.add('selected');
                }
            });
            
            // Cambiar título del formulario
            document.querySelector('#observation-form .form-header h3').textContent = 'Editar Observación';
            
            // Scroll al formulario
            scrollToForm();
            
            showNotification('Modo edición activado', 'info');
        }

        function deleteObservation(id) {
            if (!confirm('¿Está seguro de eliminar esta observación? Esta acción no se puede deshacer.')) {
                return;
            }
            
            observations = observations.filter(o => o.id !== id);
            saveObservations();
            updateUI();
            filterObservations();
            showNotification('Observación eliminada', 'success');
        }

        function updateStatus(id, newStatus) {
            const observation = observations.find(o => o.id === id);
            if (observation) {
                observation.status = newStatus;
                observation.updatedAt = new Date().toISOString();
                saveObservations();
                updateUI();
                filterObservations();
                showNotification('Estado actualizado', 'success');
            }
        }

        function clearForm() {
            editingId = null;
            document.getElementById('observation-form').reset();
            document.getElementById('priority').value = 'medium';
            document.getElementById('status').value = 'pending';
            
            // Restaurar selectores UI
            document.querySelectorAll('.priority-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.priority === 'medium') {
                    o.classList.add('selected');
                }
            });
            
            document.querySelectorAll('.status-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.status === 'pending') {
                    o.classList.add('selected');
                }
            });
            
            document.querySelector('#observation-form .form-header h3').textContent = 'Nueva Observación / Corrección';
        }

        function loadObservations() {
            const saved = localStorage.getItem('professionalCorrections');
            if (saved) {
                observations = JSON.parse(saved);
            }
            updateDocumentFilter();
        }

        function saveObservations() {
            localStorage.setItem('professionalCorrections', JSON.stringify(observations));
        }

        function updateUI() {
            // Actualizar estadísticas
            const total = observations.length;
            const pending = observations.filter(o => o.status === 'pending').length;
            const highPriority = observations.filter(o => o.priority === 'high').length;
            const documents = [...new Set(observations.map(o => o.document))].length;
            
            document.getElementById('total-observations').textContent = total;
            document.getElementById('pending-count').textContent = pending;
            document.getElementById('high-priority-count').textContent = highPriority;
            document.getElementById('documents-count').textContent = documents;
            
            updateDocumentFilter();
        }

        function updateDocumentFilter() {
            const select = document.getElementById('filter-document');
            const currentValue = select.value;
            
            // Obtener documentos únicos
            const documents = ['all', ...new Set(observations.map(o => o.document))];
            
            // Limpiar opciones
            select.innerHTML = '';
            
            // Agregar opciones
            documents.forEach(doc => {
                const option = document.createElement('option');
                option.value = doc;
                option.textContent = doc === 'all' ? 'Todos los documentos' : doc;
                select.appendChild(option);
            });
            
            // Restaurar valor anterior si existe
            if (documents.includes(currentValue)) {
                select.value = currentValue;
                currentFilter.document = currentValue;
            } else {
                select.value = 'all';
                currentFilter.document = 'all';
            }
        }

        function filterObservations() {
            let filtered = [...observations];
            
            // Aplicar filtros
            if (currentFilter.priority !== 'all') {
                filtered = filtered.filter(o => o.priority === currentFilter.priority);
            }
            
            if (currentFilter.status !== 'all') {
                filtered = filtered.filter(o => o.status === currentFilter.status);
            }
            
            if (currentFilter.document !== 'all') {
                filtered = filtered.filter(o => o.document === currentFilter.document);
            }
            
            if (currentFilter.search) {
                const searchTerm = currentFilter.search.toLowerCase();
                filtered = filtered.filter(o => 
                    o.document.toLowerCase().includes(searchTerm) ||
                    o.title.toLowerCase().includes(searchTerm) ||
                    o.details.toLowerCase().includes(searchTerm) ||
                    o.category.toLowerCase().includes(searchTerm) ||
                    (o.reference && o.reference.toLowerCase().includes(searchTerm))
                );
            }
            
            renderObservations(filtered);
        }

        function renderObservations(obsList) {
            const container = document.getElementById('observations-list');
            
            if (obsList.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>No hay observaciones</h3>
                        <p>${currentFilter.search ? 'No se encontraron resultados para tu búsqueda' : 
                           currentFilter.priority !== 'all' || currentFilter.status !== 'all' || currentFilter.document !== 'all' ? 
                           'No hay observaciones con los filtros aplicados' : 
                           'Comienza agregando tu primera observación'}</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = obsList.map(obs => `
                <div class="observation-card ${obs.priority}">
                    <div class="observation-actions">
                        <div class="action-icon" title="Editar" onclick="editObservation(${obs.id})">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="action-icon" title="Eliminar" onclick="deleteObservation(${obs.id})">
                            <i class="fas fa-trash"></i>
                        </div>
                    </div>
                    
                    <div class="observation-header">
                        <div>
                            <div class="observation-title">${escapeHtml(obs.title)}</div>
                            <div class="observation-document">
                                <i class="fas fa-file-alt"></i>
                                ${escapeHtml(obs.document)}
                            </div>
                        </div>
                        <div class="observation-priority priority-${obs.priority}">
                            ${obs.priority === 'high' ? 'Alta' : obs.priority === 'medium' ? 'Media' : 'Baja'}
                        </div>
                    </div>
                    
                    <div class="observation-content">
                        ${formatObservationDetails(obs.details)}
                    </div>
                    
                    ${obs.reference ? `
                    <div class="observation-reference">
                        <div class="reference-label">Referencia:</div>
                        <div>${escapeHtml(obs.reference)}</div>
                    </div>
                    ` : ''}
                    
                    <div class="observation-meta">
                        <div class="observation-date">
                            <i class="far fa-calendar"></i>
                            ${obs.formattedDate}
                            <span style="margin-left: 10px;">
                                <i class="fas fa-tag"></i> ${getCategoryName(obs.category)}
                            </span>
                        </div>
                        <div>
                            <span class="observation-status status-${obs.status}">
                                ${getStatusName(obs.status)}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function formatObservationDetails(details) {
            // Convertir viñetas en HTML
            let formatted = escapeHtml(details);
            
            // Reemplazar viñetas con listas HTML
            formatted = formatted.replace(/^[•\-\*]\s*(.+)$/gm, '<li>$1</li>');
            
            // Si hay li elementos, envolver en ul
            if (formatted.includes('<li>')) {
                formatted = formatted.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            }
            
            // Mantener saltos de línea
            formatted = formatted.replace(/\n/g, '<br>');
            
            return formatted;
        }

        function resetFilters() {
            currentFilter = {
                priority: 'all',
                status: 'all',
                document: 'all',
                search: ''
            };
            
            document.getElementById('filter-priority').value = 'all';
            document.getElementById('filter-status').value = 'all';
            document.getElementById('filter-document').value = 'all';
            document.getElementById('search-observations').value = '';
            
            filterObservations();
        }

        function clearCompletedObservations() {
            if (!confirm('¿Eliminar todas las observaciones completadas?')) {
                return;
            }
            
            const completedCount = observations.filter(o => o.status === 'completed').length;
            observations = observations.filter(o => o.status !== 'completed');
            
            saveObservations();
            updateUI();
            filterObservations();
            
            showNotification(`${completedCount} observaciones completadas eliminadas`, 'success');
        }

        function scrollToForm() {
            document.getElementById('observation-form').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        function generateExport(format) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configuración del reporte
            const pageWidth = doc.internal.pageSize.getWidth();
            const margin = 20;
            let yPos = margin;
            
            // Título principal
            doc.setFontSize(20);
            doc.setTextColor(26, 54, 93);
            doc.setFont('helvetica', 'bold');
            doc.text('OBSERVACIONES REGISTRADAS', pageWidth / 2, yPos, { align: 'center' });
            yPos += 15;
            
            // Subtítulo
            doc.setFontSize(11);
            doc.setTextColor(113, 128, 150);
            doc.setFont('helvetica', 'normal');
            doc.text(`Proyecto: Expediente Técnico | Generado: ${new Date().toLocaleDateString('es-ES')}`, 
                    pageWidth / 2, yPos, { align: 'center' });
            yPos += 20;
            
            if (format === 'pdf-summary') {
                generateSummaryPDF(doc, pageWidth, margin, yPos);
            } else {
                generateDetailedPDF(doc, pageWidth, margin, yPos);
            }
            
            // Guardar PDF
            const fileName = `observaciones-${new Date().toISOString().slice(0,10)}.pdf`;
            doc.save(fileName);
            
            // Cerrar modal y mostrar notificación
            document.getElementById('export-modal').classList.remove('active');
            showNotification(`Reporte PDF generado: ${fileName}`, 'success');
        }

        function generateSummaryPDF(doc, pageWidth, margin, yPos) {
            // Tabla de resumen
            doc.setFontSize(14);
            doc.setTextColor(26, 54, 93);
            doc.setFont('helvetica', 'bold');
            doc.text('RESUMEN DE OBSERVACIONES', margin, yPos);
            yPos += 10;
            
            // Datos para la tabla de resumen
            const summaryData = [];
            
            // Agrupar por documento
            const byDocument = {};
            observations.forEach(obs => {
                if (!byDocument[obs.document]) {
                    byDocument[obs.document] = { total: 0, pending: 0, completed: 0 };
                }
                byDocument[obs.document].total++;
                if (obs.status === 'pending' || obs.status === 'in-progress') {
                    byDocument[obs.document].pending++;
                } else if (obs.status === 'completed') {
                    byDocument[obs.document].completed++;
                }
            });
            
            // Agregar filas a la tabla
            Object.keys(byDocument).forEach(docName => {
                const stats = byDocument[docName];
                summaryData.push([
                    docName,
                    stats.total.toString(),
                    stats.pending.toString(),
                    stats.completed.toString()
                ]);
            });
            
            // Crear tabla de resumen
            doc.autoTable({
                startY: yPos,
                head: [['Documento', 'Total', 'Pendientes', 'Completadas']],
                body: summaryData,
                margin: { left: margin, right: margin },
                headStyles: {
                    fillColor: [26, 54, 93],
                    textColor: [255, 255, 255],
                    fontSize: 10,
                    fontStyle: 'bold'
                },
                bodyStyles: {
                    fontSize: 9
                },
                alternateRowStyles: {
                    fillColor: [247, 250, 252]
                },
                didDrawPage: function(data) {
                    // Footer
                    addPDFFooter(doc, pageWidth);
                }
            });
            
            // Obtener posición Y después de la tabla
            let finalY = doc.lastAutoTable.finalY || yPos;
            
            // Espacio después de la tabla
            finalY += 15;
            
            // Lista detallada
            doc.setFontSize(14);
            doc.setTextColor(26, 54, 93);
            doc.setFont('helvetica', 'bold');
            doc.text('LISTA DE OBSERVACIONES', margin, finalY);
            finalY += 10;
            
            // Agregar cada observación en formato lista
            doc.setFontSize(10);
            doc.setTextColor(45, 55, 72);
            doc.setFont('helvetica', 'normal');
            
            observations.forEach((obs, index) => {
                // Verificar espacio en página
                if (finalY > 250) {
                    doc.addPage();
                    finalY = margin;
                }
                
                // Título de la observación
                doc.setFont('helvetica', 'bold');
                doc.text(`${index + 1}. ${obs.title}`, margin, finalY);
                finalY += 6;
                
                // Documento
                doc.setFont('helvetica', 'normal');
                doc.text(`Documento: ${obs.document}`, margin + 5, finalY);
                finalY += 5;
                
                // Detalles (con viñetas)
                const details = obs.details.split('\n');
                details.forEach(detail => {
                    const trimmed = detail.trim();
                    if (trimmed) {
                        if (finalY > 280) {
                            doc.addPage();
                            finalY = margin;
                        }
                        
                        // Detectar viñetas
                        if (trimmed.startsWith('•') || trimmed.startsWith('-') || trimmed.startsWith('*')) {
                            doc.text(`  • ${trimmed.substring(1).trim()}`, margin + 5, finalY);
                        } else {
                            doc.text(`  ${trimmed}`, margin + 5, finalY);
                        }
                        finalY += 5;
                    }
                });
                
                // Referencia
                if (obs.reference) {
                    if (finalY > 280) {
                        doc.addPage();
                        finalY = margin;
                    }
                    doc.text(`Referencia: ${obs.reference}`, margin + 5, finalY);
                    finalY += 5;
                }
                
                // Estado y fecha
                if (finalY > 280) {
                    doc.addPage();
                    finalY = margin;
                }
                doc.text(`Estado: ${getStatusName(obs.status)} | Fecha: ${new Date(obs.createdAt).toLocaleDateString('es-ES')}`, 
                        margin + 5, finalY);
                finalY += 10;
                
                // Línea separadora
                if (index < observations.length - 1) {
                    doc.setDrawColor(200, 200, 200);
                    doc.line(margin, finalY, pageWidth - margin, finalY);
                    finalY += 5;
                }
            });
        }

        function generateDetailedPDF(doc, pageWidth, margin, yPos) {
            // Agregar cada observación con formato de imagen de referencia
            observations.forEach((obs, index) => {
                // Verificar si necesitamos nueva página (excepto para la primera)
                if (index > 0 && yPos > 200) {
                    doc.addPage();
                    yPos = margin;
                }
                
                // Título principal de la observación
                doc.setFontSize(16);
                doc.setTextColor(26, 54, 93);
                doc.setFont('helvetica', 'bold');
                
                // Dividir título largo
                const titleLines = doc.splitTextToSize(obs.title, pageWidth - 2 * margin);
                titleLines.forEach(line => {
                    doc.text(line, margin, yPos);
                    yPos += 7;
                });
                
                yPos += 3;
                
                // Documento
                doc.setFontSize(11);
                doc.setTextColor(49, 130, 206);
                doc.setFont('helvetica', 'bold');
                doc.text(`• ${obs.document}`, margin, yPos);
                yPos += 7;
                
                // Detalles con viñetas
                doc.setFontSize(10);
                doc.setTextColor(45, 55, 72);
                doc.setFont('helvetica', 'normal');
                
                const details = obs.details.split('\n');
                details.forEach(detail => {
                    const trimmed = detail.trim();
                    if (trimmed) {
                        // Detectar viñetas
                        if (trimmed.startsWith('•') || trimmed.startsWith('-') || trimmed.startsWith('*')) {
                            const bulletContent = trimmed.substring(1).trim();
                            const bulletLines = doc.splitTextToSize(bulletContent, pageWidth - 2 * margin - 10);
                            bulletLines.forEach((line, lineIndex) => {
                                const prefix = lineIndex === 0 ? '• ' : '  ';
                                doc.text(prefix + line, margin + 5, yPos);
                                yPos += 5;
                            });
                        } else {
                            const detailLines = doc.splitTextToSize(trimmed, pageWidth - 2 * margin - 5);
                            detailLines.forEach(line => {
                                doc.text(line, margin + 5, yPos);
                                yPos += 5;
                            });
                        }
                    }
                });
                
                yPos += 3;
                
                // Referencia
                if (obs.reference) {
                    doc.setFont('helvetica', 'bold');
                    doc.text(`Referencia: ${obs.reference}`, margin, yPos);
                    yPos += 6;
                }
                
                // Información adicional
                doc.setFontSize(9);
                doc.setTextColor(113, 128, 150);
                doc.setFont('helvetica', 'normal');
                
                const dateStr = new Date(obs.createdAt).toLocaleDateString('es-ES', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                doc.text(dateStr, margin, yPos);
                
                // Categoría y estado alineados a la derecha
                const statusText = `[${getStatusSymbol(obs.status)}] ${getCategoryName(obs.category)}`;
                const statusWidth = doc.getTextWidth(statusText);
                doc.text(statusText, pageWidth - margin - statusWidth, yPos);
                
                yPos += 15;
                
                // Línea separadora (excepto para la última)
                if (index < observations.length - 1) {
                    doc.setDrawColor(200, 200, 200);
                    doc.line(margin, yPos, pageWidth - margin, yPos);
                    yPos += 10;
                }
            });
            
            // Footer
            addPDFFooter(doc, pageWidth);
        }

        function addPDFFooter(doc, pageWidth) {
            const pageHeight = doc.internal.pageSize.getHeight();
            
            doc.setFontSize(8);
            doc.setTextColor(113, 128, 150);
            doc.text(
                'Sistema Profesional de Correcciones y Observaciones - Registro Técnico',
                pageWidth / 2,
                pageHeight - 10,
                { align: 'center' }
            );
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const title = document.getElementById('notification-title');
            const msg = document.getElementById('notification-message');
            const icon = notification.querySelector('.notification-icon i');
            
            // Configurar según tipo
            notification.className = `notification ${type}`;
            
            if (type === 'success') {
                title.textContent = 'Éxito';
                icon.className = 'fas fa-check';
            } else if (type === 'error') {
                title.textContent = 'Error';
                icon.className = 'fas fa-exclamation-triangle';
            } else if (type === 'info') {
                title.textContent = 'Información';
                icon.className = 'fas fa-info-circle';
            }
            
            msg.textContent = message;
            
            // Mostrar
            notification.classList.add('show');
            
            // Ocultar después de 3 segundos
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function formatDate(date) {
            return date.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function getCategoryName(category) {
            const categories = {
                'plano': 'Plano',
                'memoria': 'Memoria de Cálculo',
                'especificacion': 'Especificación Técnica',
                'documentacion': 'Documentación General',
                'normativa': 'Normativa',
                'otros': 'Otros'
            };
            return categories[category] || category;
        }

        function getStatusName(status) {
            const statuses = {
                'pending': 'Pendiente',
                'in-progress': 'En Progreso',
                'completed': 'Completado',
                'cancelled': 'Cancelado'
            };
            return statuses[status] || status;
        }

        function getStatusSymbol(status) {
            const symbols = {
                'pending': 'PEND',
                'in-progress': 'PROG',
                'completed': 'COMP',
                'cancelled': 'CANC'
            };
            return symbols[status] || status;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
