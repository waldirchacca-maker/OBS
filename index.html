<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Din√°mico de Correcciones y Observaciones</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2d3748;
            --accent: #3182ce;
            --success: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --light: #f7fafc;
            --dark: #2d3748;
            --gray: #718096;
            --light-gray: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 10px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f6f8fc 0%, #edf2f7 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-gray);
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .logo-text h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }

        .logo-text p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent);
            transform: translateX(-100%);
            transition: transform 0.5s ease;
        }

        .stat-card.updated::after {
            transform: translateX(0);
            animation: slideIn 2s ease;
        }

        @keyframes slideIn {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(0); }
            100% { transform: translateX(100%); }
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
            transition: all 0.3s ease;
        }

        .stat-number.updated {
            color: var(--accent);
            transform: scale(1.1);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--gray);
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--accent);
        }

        .action-btn {
            width: 100%;
            padding: 14px;
            margin-bottom: 12px;
            border: none;
            border-radius: 8px;
            background: var(--light);
            color: var(--dark);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .action-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateX(5px);
        }

        .action-btn.primary {
            background: var(--accent);
            color: white;
        }

        .action-btn.primary:hover {
            background: var(--primary);
        }

        /* Live Updates Indicator */
        .live-updates {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 12px;
            background: rgba(56, 161, 105, 0.1);
            border-radius: 8px;
            color: var(--success);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .live-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        /* Header */
        .header {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .header-title p {
            color: var(--gray);
            font-size: 0.95rem;
        }

        .last-update {
            background: var(--light);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            color: var(--primary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Form Card */
        .form-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            transition: var(--transition);
        }

        .form-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .form-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-gray);
        }

        .form-header i {
            color: var(--accent);
            font-size: 1.5rem;
        }

        .form-header h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: span 2;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--secondary);
            font-size: 0.95rem;
        }

        input, textarea, select {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: white;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        /* Priority Selector */
        .priority-selector {
            display: flex;
            gap: 10px;
        }

        .priority-option {
            flex: 1;
            text-align: center;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .priority-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: currentColor;
            opacity: 0;
            transition: var(--transition);
        }

        .priority-option:hover::before {
            opacity: 1;
        }

        .priority-option.selected::before {
            opacity: 1;
        }

        .priority-option.low { color: var(--success); border-color: var(--success); }
        .priority-option.medium { color: var(--warning); border-color: var(--warning); }
        .priority-option.high { color: var(--danger); border-color: var(--danger); }

        .priority-option.low.selected { background: rgba(56, 161, 105, 0.1); }
        .priority-option.medium.selected { background: rgba(214, 158, 46, 0.1); }
        .priority-option.high.selected { background: rgba(229, 62, 62, 0.1); }

        /* Status Selector */
        .status-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .status-option {
            padding: 10px 20px;
            border: 2px solid var(--light-gray);
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .status-option:hover {
            transform: translateY(-2px);
        }

        .status-option.selected {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
        }

        /* Buttons */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(49, 130, 206, 0.3);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 2px solid var(--light-gray);
        }

        .btn-secondary:hover {
            background: var(--light-gray);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--light-gray);
        }

        /* Observations Container */
        .observations-container {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
        }

        .observations-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .observations-header h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
        }

        /* Observations Grid */
        .observations-grid {
            display: grid;
            gap: 20px;
            min-height: 200px;
        }

        .observation-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--accent);
            padding: 25px;
            transition: var(--transition);
            position: relative;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .observation-card.new {
            border-color: var(--success);
            animation: highlight 1s ease;
        }

        @keyframes highlight {
            0% { box-shadow: 0 0 0 0 rgba(56, 161, 105, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(56, 161, 105, 0); }
            100% { box-shadow: 0 0 0 0 rgba(56, 161, 105, 0); }
        }

        .observation-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .observation-card.high { border-left-color: var(--danger); }
        .observation-card.medium { border-left-color: var(--warning); }
        .observation-card.low { border-left-color: var(--success); }

        .observation-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .observation-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .observation-document {
            color: var(--accent);
            font-weight: 500;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .observation-document i {
            font-size: 0.9rem;
        }

        .observation-priority {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-high { background: rgba(229, 62, 62, 0.1); color: var(--danger); }
        .priority-medium { background: rgba(214, 158, 46, 0.1); color: var(--warning); }
        .priority-low { background: rgba(56, 161, 105, 0.1); color: var(--success); }

        .observation-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
            font-size: 0.9rem;
            color: var(--gray);
        }

        .observation-date {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .observation-status {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .observation-status:hover {
            transform: scale(1.05);
        }

        .status-pending { background: rgba(214, 158, 46, 0.1); color: var(--warning); }
        .status-in-progress { background: rgba(49, 130, 206, 0.1); color: var(--accent); }
        .status-completed { background: rgba(56, 161, 105, 0.1); color: var(--success); }
        .status-cancelled { background: rgba(113, 128, 150, 0.1); color: var(--gray); }

        .observation-actions {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            opacity: 0;
            transition: var(--transition);
        }

        .observation-card:hover .observation-actions {
            opacity: 1;
        }

        .action-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light);
            color: var(--dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .action-icon:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        .observation-content {
            color: var(--secondary);
            line-height: 1.6;
            margin-top: 15px;
        }

        .observation-reference {
            margin-top: 15px;
            padding: 10px 15px;
            background: var(--light);
            border-radius: 6px;
            border-left: 3px solid var(--accent);
        }

        .reference-label {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--light-gray);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--gray);
        }

        /* Auto-refresh Indicator */
        .auto-refresh {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px 15px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--gray);
            z-index: 100;
        }

        .refresh-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 1.5s infinite;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-group.full-width {
                grid-column: span 1;
            }
            
            .observations-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .search-box {
                width: 100%;
            }
            
            .form-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .priority-selector {
                flex-direction: column;
            }
            
            .stat-card {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div class="logo-text">
                    <h1>Correcciones LIVE</h1>
                    <p>Actualizaci√≥n en tiempo real</p>
                </div>
            </div>

            <div class="live-updates">
                <div class="live-dot"></div>
                <span>Actualizando en tiempo real</span>
            </div>

            <div class="stats-grid">
                <div class="stat-card" id="stat-total">
                    <div class="stat-number" id="total-observations">0</div>
                    <div class="stat-label">Observaciones</div>
                </div>
                <div class="stat-card" id="stat-pending">
                    <div class="stat-number" id="pending-count">0</div>
                    <div class="stat-label">Pendientes</div>
                </div>
                <div class="stat-card" id="stat-high">
                    <div class="stat-number" id="high-priority-count">0</div>
                    <div class="stat-label">Alta Prioridad</div>
                </div>
                <div class="stat-card" id="stat-docs">
                    <div class="stat-number" id="documents-count">0</div>
                    <div class="stat-label">Documentos</div>
                </div>
            </div>

            <div class="quick-actions">
                <h3 class="section-title"><i class="fas fa-bolt"></i> Acciones R√°pidas</h3>
                <button class="action-btn primary" id="new-observation-btn">
                    <i class="fas fa-plus"></i> Nueva Observaci√≥n
                </button>
                <button class="action-btn" id="clear-form-btn-sidebar">
                    <i class="fas fa-broom"></i> Limpiar Formulario
                </button>
                <button class="action-btn" id="refresh-data-btn">
                    <i class="fas fa-redo"></i> Refrescar Datos
                </button>
                <button class="action-btn" id="export-pdf-btn">
                    <i class="fas fa-file-pdf"></i> Generar Reporte
                </button>
            </div>

            <div class="recent-documents" style="margin-top: 30px;">
                <h3 class="section-title"><i class="fas fa-file-alt"></i> Documentos Recientes</h3>
                <div id="recent-documents-list" style="max-height: 200px; overflow-y: auto;">
                    <p style="text-align: center; color: var(--gray); padding: 10px; font-size: 0.9rem;">
                        No hay documentos a√∫n
                    </p>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-title">
                    <h2 id="page-title">Registro Din√°mico de Correcciones</h2>
                    <p>Los datos se actualizan autom√°ticamente en tiempo real</p>
                </div>
                <div class="last-update">
                    <i class="fas fa-clock"></i>
                    <span id="last-update-time">Actualizado hace 0 segundos</span>
                </div>
            </div>

            <!-- Formulario de Observaci√≥n -->
            <div class="form-card" id="observation-form">
                <div class="form-header">
                    <i class="fas fa-edit"></i>
                    <h3 id="form-title">Nueva Observaci√≥n / Correcci√≥n</h3>
                    <span id="form-status" style="margin-left: auto; font-size: 0.9rem; color: var(--accent);">
                        <i class="fas fa-pen"></i> Modo: Nuevo
                    </span>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="document-name">
                            <i class="fas fa-file-alt"></i> Nombre del Documento
                            <span id="doc-count" style="float: right; font-size: 0.8rem; color: var(--accent);"></span>
                        </label>
                        <input type="text" id="document-name" placeholder="Ej. TISUR-1502-042-DWG-00001_B" required>
                        <div id="document-suggestions" style="margin-top: 5px; font-size: 0.8rem; color: var(--gray);"></div>
                    </div>

                    <div class="form-group">
                        <label for="observation-title"><i class="fas fa-heading"></i> T√≠tulo de la Observaci√≥n</label>
                        <input type="text" id="observation-title" placeholder="Ej. Correcci√≥n del N√öMERO DE PLANO PROVEEDOR" required>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-exclamation-circle"></i> Prioridad</label>
                        <div class="priority-selector">
                            <div class="priority-option low" data-priority="low">
                                Baja
                            </div>
                            <div class="priority-option medium selected" data-priority="medium">
                                Media
                            </div>
                            <div class="priority-option high" data-priority="high">
                                Alta
                            </div>
                        </div>
                        <input type="hidden" id="priority" value="medium">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-tasks"></i> Estado</label>
                        <div class="status-selector">
                            <div class="status-option selected" data-status="pending">Pendiente</div>
                            <div class="status-option" data-status="in-progress">En Progreso</div>
                            <div class="status-option" data-status="completed">Completado</div>
                            <div class="status-option" data-status="cancelled">Cancelado</div>
                        </div>
                        <input type="hidden" id="status" value="pending">
                    </div>

                    <div class="form-group full-width">
                        <label for="observation-details">
                            <i class="fas fa-align-left"></i> Descripci√≥n Detallada
                            <span style="float: right; font-size: 0.8rem; color: var(--gray);" id="char-count">0 caracteres</span>
                        </label>
                        <textarea id="observation-details" placeholder="Describe detalladamente la observaci√≥n. Usa vi√±etas (‚Ä¢) para organizar la informaci√≥n:" rows="4" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="observation-reference"><i class="fas fa-hashtag"></i> Referencia (N√∫mero)</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="observation-reference" placeholder="Auto-generado" style="flex: 1;" readonly>
                            <button type="button" id="generate-ref-btn" class="btn-secondary" style="padding: 10px 15px;">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="observation-category"><i class="fas fa-tag"></i> Categor√≠a</label>
                        <select id="observation-category">
                            <option value="plano">Plano</option>
                            <option value="memoria">Memoria de C√°lculo</option>
                            <option value="especificacion">Especificaci√≥n T√©cnica</option>
                            <option value="documentacion">Documentaci√≥n General</option>
                            <option value="normativa">Normativa</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-edit-btn" style="display: none;">
                        <i class="fas fa-times"></i> Cancelar Edici√≥n
                    </button>
                    <button type="button" class="btn btn-secondary" id="clear-form-btn">
                        <i class="fas fa-broom"></i> Limpiar Todo
                    </button>
                    <button type="submit" class="btn btn-primary" id="save-observation-btn">
                        <i class="fas fa-save"></i> Guardar Observaci√≥n
                    </button>
                </div>
            </div>

            <!-- Lista de Observaciones -->
            <div class="observations-container">
                <div class="observations-header">
                    <div>
                        <h3>Observaciones Registradas</h3>
                        <p style="font-size: 0.9rem; color: var(--gray); margin-top: 5px;" id="observations-count">
                            Mostrando 0 de 0 observaciones
                        </p>
                    </div>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-observations" placeholder="Buscar observaciones...">
                    </div>
                </div>

                <div class="observations-grid" id="observations-list">
                    <!-- Las observaciones se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Auto-refresh Indicator -->
    <div class="auto-refresh">
        <div class="refresh-dot"></div>
        <span>Sistema activo</span>
    </div>

    <script>
        // Variables globales
        let observations = [];
        let editingId = null;
        let currentFilter = {
            priority: 'all',
            status: 'all',
            document: 'all',
            search: ''
        };
        let lastUpdateTime = Date.now();
        let autoUpdateInterval;
        let nextReference = 1;

        // Inicializar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadObservations();
            updateAll();
            startAutoUpdate();
            
            // Agregar observaci√≥n de ejemplo si no hay datos
            if (observations.length === 0) {
                addExampleObservation();
            }
        });

        function initializeApp() {
            // Calcular siguiente referencia
            calculateNextReference();
            
            // Actualizar contador de caracteres
            document.getElementById('observation-details').addEventListener('input', function() {
                document.getElementById('char-count').textContent = 
                    `${this.value.length} caracteres`;
            });
            
            // Generar referencia autom√°ticamente
            document.getElementById('generate-ref-btn').addEventListener('click', generateReference);
            
            // Auto-generar referencia inicial
            generateReference();
        }

        function startAutoUpdate() {
            // Actualizar cada 2 segundos
            autoUpdateInterval = setInterval(() => {
                updateLastUpdateTime();
                updateStatsAnimation();
            }, 2000);
            
            // Actualizar contador de tiempo
            setInterval(updateLastUpdateTime, 1000);
        }

        function setupEventListeners() {
            // Formulario
            document.getElementById('save-observation-btn').addEventListener('click', saveObservation);
            document.getElementById('clear-form-btn').addEventListener('click', clearForm);
            document.getElementById('clear-form-btn-sidebar').addEventListener('click', clearForm);
            document.getElementById('cancel-edit-btn').addEventListener('click', cancelEdit);
            
            // Prioridad
            document.querySelectorAll('.priority-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.priority-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('priority').value = this.dataset.priority;
                });
            });
            
            // Estado
            document.querySelectorAll('.status-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.status-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('status').value = this.dataset.status;
                });
            });
            
            // Botones de acci√≥n
            document.getElementById('new-observation-btn').addEventListener('click', () => {
                clearForm();
                scrollToForm();
            });
            
            document.getElementById('refresh-data-btn').addEventListener('click', refreshData);
            
            document.getElementById('export-pdf-btn').addEventListener('click', exportToPDF);
            
            // B√∫squeda
            document.getElementById('search-observations').addEventListener('input', debounce(function() {
                currentFilter.search = this.value.toLowerCase();
                filterObservations();
            }, 300));
            
            // Autocompletar documento
            document.getElementById('document-name').addEventListener('input', function() {
                showDocumentSuggestions(this.value);
            });
        }

        function saveObservation() {
            const documentName = document.getElementById('document-name').value.trim();
            const title = document.getElementById('observation-title').value.trim();
            const priority = document.getElementById('priority').value;
            const status = document.getElementById('status').value;
            const details = document.getElementById('observation-details').value.trim();
            const reference = document.getElementById('observation-reference').value.trim();
            const category = document.getElementById('observation-category').value;
            
            // Validaci√≥n
            if (!documentName || !title || !details) {
                showNotification('Por favor complete todos los campos requeridos', 'error');
                return;
            }
            
            const observation = {
                id: editingId || Date.now(),
                document: documentName,
                title: title,
                priority: priority,
                status: status,
                details: details,
                reference: reference || `REF-${Date.now().toString().slice(-6)}`,
                category: category,
                createdAt: editingId ? observations.find(o => o.id === editingId).createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                formattedDate: formatDate(new Date()),
                isNew: !editingId // Marcar como nuevo si no es edici√≥n
            };
            
            if (editingId) {
                // Actualizar observaci√≥n existente
                const index = observations.findIndex(o => o.id === editingId);
                observations[index] = observation;
                showNotification('‚úÖ Observaci√≥n actualizada correctamente', 'success');
            } else {
                // Nueva observaci√≥n
                observation.id = Date.now();
                observation.isNew = true;
                observations.unshift(observation);
                
                // Actualizar siguiente referencia
                if (reference && /^\d+$/.test(reference)) {
                    nextReference = Math.max(nextReference, parseInt(reference) + 1);
                }
                
                showNotification('‚úÖ Observaci√≥n guardada correctamente', 'success');
                
                // Mostrar animaci√≥n de nueva observaci√≥n
                setTimeout(() => {
                    const newCard = document.querySelector('.observation-card.new');
                    if (newCard) {
                        newCard.classList.remove('new');
                    }
                }, 1000);
            }
            
            // Guardar en localStorage
            saveObservations();
            
            // Actualizar UI
            clearForm();
            updateAll();
            filterObservations();
            
            // Scroll a la lista si es nueva observaci√≥n
            if (!editingId) {
                setTimeout(() => {
                    document.getElementById('observations-list').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            }
            
            // Generar nueva referencia
            generateReference();
        }

        function editObservation(id) {
            const observation = observations.find(o => o.id === id);
            if (!observation) return;
            
            editingId = id;
            
            // Llenar formulario
            document.getElementById('document-name').value = observation.document;
            document.getElementById('observation-title').value = observation.title;
            document.getElementById('priority').value = observation.priority;
            document.getElementById('status').value = observation.status;
            document.getElementById('observation-details').value = observation.details;
            document.getElementById('observation-reference').value = observation.reference || '';
            document.getElementById('observation-category').value = observation.category;
            
            // Actualizar selectores UI
            document.querySelectorAll('.priority-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.priority === observation.priority) {
                    o.classList.add('selected');
                }
            });
            
            document.querySelectorAll('.status-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.status === observation.status) {
                    o.classList.add('selected');
                }
            });
            
            // Actualizar contador de caracteres
            document.getElementById('char-count').textContent = 
                `${observation.details.length} caracteres`;
            
            // Cambiar t√≠tulo del formulario
            document.getElementById('form-title').textContent = 'Editar Observaci√≥n';
            document.getElementById('form-status').innerHTML = '<i class="fas fa-edit"></i> Modo: Edici√≥n';
            
            // Mostrar bot√≥n cancelar
            document.getElementById('cancel-edit-btn').style.display = 'inline-flex';
            
            // Scroll al formulario
            scrollToForm();
            
            showNotification('‚úèÔ∏è Modo edici√≥n activado', 'info');
        }

        function cancelEdit() {
            clearForm();
            showNotification('Edici√≥n cancelada', 'info');
        }

        function deleteObservation(id) {
            if (!confirm('¬øEst√° seguro de eliminar esta observaci√≥n? Esta acci√≥n no se puede deshacer.')) {
                return;
            }
            
            observations = observations.filter(o => o.id !== id);
            saveObservations();
            updateAll();
            filterObservations();
            showNotification('üóëÔ∏è Observaci√≥n eliminada', 'success');
        }

        function updateStatus(id, newStatus) {
            const observation = observations.find(o => o.id === id);
            if (observation) {
                observation.status = newStatus;
                observation.updatedAt = new Date().toISOString();
                saveObservations();
                updateAll();
                filterObservations();
                showNotification('üîÑ Estado actualizado', 'success');
            }
        }

        function clearForm() {
            editingId = null;
            
            // Resetear formulario
            document.getElementById('document-name').value = '';
            document.getElementById('observation-title').value = '';
            document.getElementById('observation-details').value = '';
            document.getElementById('observation-reference').value = '';
            
            // Resetear valores por defecto
            document.getElementById('priority').value = 'medium';
            document.getElementById('status').value = 'pending';
            document.getElementById('observation-category').value = 'plano';
            
            // Restaurar selectores UI
            document.querySelectorAll('.priority-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.priority === 'medium') {
                    o.classList.add('selected');
                }
            });
            
            document.querySelectorAll('.status-option').forEach(o => {
                o.classList.remove('selected');
                if (o.dataset.status === 'pending') {
                    o.classList.add('selected');
                }
            });
            
            // Restaurar t√≠tulo y estado del formulario
            document.getElementById('form-title').textContent = 'Nueva Observaci√≥n / Correcci√≥n';
            document.getElementById('form-status').innerHTML = '<i class="fas fa-pen"></i> Modo: Nuevo';
            
            // Ocultar bot√≥n cancelar
            document.getElementById('cancel-edit-btn').style.display = 'none';
            
            // Actualizar contadores
            document.getElementById('char-count').textContent = '0 caracteres';
            document.getElementById('doc-count').textContent = '';
            document.getElementById('document-suggestions').innerHTML = '';
            
            // Generar nueva referencia
            generateReference();
            
            // Focus en el primer campo
            document.getElementById('document-name').focus();
        }

        function generateReference() {
            calculateNextReference();
            document.getElementById('observation-reference').value = nextReference.toString();
        }

        function calculateNextReference() {
            // Encontrar el n√∫mero de referencia m√°s alto
            let maxRef = 0;
            observations.forEach(obs => {
                if (obs.reference && /^\d+$/.test(obs.reference)) {
                    const refNum = parseInt(obs.reference);
                    if (refNum > maxRef) {
                        maxRef = refNum;
                    }
                }
            });
            nextReference = maxRef + 1;
        }

        function loadObservations() {
            const saved = localStorage.getItem('dynamicCorrections');
            if (saved) {
                observations = JSON.parse(saved);
            }
        }

        function saveObservations() {
            localStorage.setItem('dynamicCorrections', JSON.stringify(observations));
            lastUpdateTime = Date.now();
        }

        function updateAll() {
            updateUI();
            updateDocumentFilter();
            updateRecentDocuments();
            updateLastUpdateTime();
        }

        function updateUI() {
            // Actualizar estad√≠sticas
            const total = observations.length;
            const pending = observations.filter(o => o.status === 'pending').length;
            const highPriority = observations.filter(o => o.priority === 'high').length;
            const documents = [...new Set(observations.map(o => o.document))].length;
            
            // Animar cambios en estad√≠sticas
            animateStatChange('total-observations', total);
            animateStatChange('pending-count', pending);
            animateStatChange('high-priority-count', highPriority);
            animateStatChange('documents-count', documents);
            
            updateDocumentFilter();
        }

        function animateStatChange(statId, newValue) {
            const element = document.getElementById(statId);
            const currentValue = parseInt(element.textContent) || 0;
            
            if (currentValue !== newValue) {
                // Animaci√≥n de cambio
                element.classList.add('updated');
                element.textContent = newValue;
                
                // Resaltar tarjeta
                const statCard = element.closest('.stat-card');
                statCard.classList.add('updated');
                
                // Remover clases despu√©s de animaci√≥n
                setTimeout(() => {
                    element.classList.remove('updated');
                    statCard.classList.remove('updated');
                }, 2000);
            } else {
                element.textContent = newValue;
            }
        }

        function updateStatsAnimation() {
            // Simular actualizaci√≥n peri√≥dica de estad√≠sticas
            document.querySelectorAll('.stat-card').forEach(card => {
                card.classList.add('updated');
                setTimeout(() => card.classList.remove('updated'), 1000);
            });
        }

        function updateDocumentFilter() {
            const uniqueDocs = [...new Set(observations.map(o => o.document))];
            
            // Actualizar contador en formulario
            const docCount = document.getElementById('doc-count');
            if (uniqueDocs.length > 0) {
                docCount.textContent = `${uniqueDocs.length} documentos registrados`;
            } else {
                docCount.textContent = '';
            }
        }

        function updateRecentDocuments() {
            const container = document.getElementById('recent-documents-list');
            const uniqueDocs = [...new Set(observations.map(o => o.document))];
            
            if (uniqueDocs.length === 0) {
                container.innerHTML = `
                    <p style="text-align: center; color: var(--gray); padding: 10px; font-size: 0.9rem;">
                        No hay documentos a√∫n
                    </p>
                `;
                return;
            }
            
            let html = '';
            uniqueDocs.slice(0, 5).forEach(doc => {
                const count = observations.filter(o => o.document === doc).length;
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; 
                          padding: 8px 12px; margin-bottom: 6px; background: var(--light); 
                          border-radius: 6px; font-size: 0.85rem;">
                        <span style="color: var(--primary); font-weight: 500;">${doc}</span>
                        <span style="background: var(--accent); color: white; padding: 2px 8px; 
                              border-radius: 10px; font-size: 0.75rem;">${count}</span>
                    </div>
                `;
            });
            
            if (uniqueDocs.length > 5) {
                html += `
                    <div style="text-align: center; color: var(--gray); padding: 5px; font-size: 0.8rem;">
                        +${uniqueDocs.length - 5} documentos m√°s
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function showDocumentSuggestions(input) {
            const container = document.getElementById('document-suggestions');
            
            if (!input) {
                container.innerHTML = '';
                return;
            }
            
            const suggestions = [...new Set(observations.map(o => o.document))]
                .filter(doc => doc.toLowerCase().includes(input.toLowerCase()))
                .slice(0, 3);
            
            if (suggestions.length > 0) {
                container.innerHTML = `
                    <div style="margin-top: 5px;">
                        <span style="color: var(--gray);">Sugerencias:</span>
                        ${suggestions.map(doc => 
                            `<div style="cursor: pointer; padding: 2px 5px; margin-top: 2px; 
                                  background: var(--light); border-radius: 3px; font-size: 0.8rem;"
                               onclick="document.getElementById('document-name').value = '${escapeHtml(doc)}'; 
                                        this.parentElement.innerHTML = '';">
                                ${escapeHtml(doc)}
                            </div>`
                        ).join('')}
                    </div>
                `;
            } else {
                container.innerHTML = '';
            }
        }

        function filterObservations() {
            let filtered = [...observations];
            
            // Aplicar filtros
            if (currentFilter.priority !== 'all') {
                filtered = filtered.filter(o => o.priority === currentFilter.priority);
            }
            
            if (currentFilter.status !== 'all') {
                filtered = filtered.filter(o => o.status === currentFilter.status);
            }
            
            if (currentFilter.document !== 'all') {
                filtered = filtered.filter(o => o.document === currentFilter.document);
            }
            
            if (currentFilter.search) {
                const searchTerm = currentFilter.search.toLowerCase();
                filtered = filtered.filter(o => 
                    o.document.toLowerCase().includes(searchTerm) ||
                    o.title.toLowerCase().includes(searchTerm) ||
                    o.details.toLowerCase().includes(searchTerm) ||
                    o.category.toLowerCase().includes(searchTerm) ||
                    (o.reference && o.reference.toLowerCase().includes(searchTerm))
                );
            }
            
            renderObservations(filtered);
            
            // Actualizar contador
            document.getElementById('observations-count').textContent = 
                `Mostrando ${filtered.length} de ${observations.length} observaciones`;
        }

        function renderObservations(obsList) {
            const container = document.getElementById('observations-list');
            
            if (obsList.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>No hay observaciones</h3>
                        <p>${currentFilter.search ? 'No se encontraron resultados para tu b√∫squeda' : 
                           currentFilter.priority !== 'all' || currentFilter.status !== 'all' || currentFilter.document !== 'all' ? 
                           'No hay observaciones con los filtros aplicados' : 
                           'Comienza agregando tu primera observaci√≥n'}</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = obsList.map(obs => `
                <div class="observation-card ${obs.priority} ${obs.isNew ? 'new' : ''}" data-id="${obs.id}">
                    <div class="observation-actions">
                        <div class="action-icon" title="Editar" onclick="editObservation(${obs.id})">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="action-icon" title="Eliminar" onclick="deleteObservation(${obs.id})">
                            <i class="fas fa-trash"></i>
                        </div>
                    </div>
                    
                    <div class="observation-header">
                        <div>
                            <div class="observation-title">${escapeHtml(obs.title)}</div>
                            <div class="observation-document">
                                <i class="fas fa-file-alt"></i>
                                ${escapeHtml(obs.document)}
                            </div>
                        </div>
                        <div class="observation-priority priority-${obs.priority}">
                            ${obs.priority === 'high' ? 'Alta' : obs.priority === 'medium' ? 'Media' : 'Baja'}
                        </div>
                    </div>
                    
                    <div class="observation-content">
                        ${formatObservationDetails(obs.details)}
                    </div>
                    
                    ${obs.reference ? `
                    <div class="observation-reference">
                        <div class="reference-label">Referencia:</div>
                        <div>${escapeHtml(obs.reference)}</div>
                    </div>
                    ` : ''}
                    
                    <div class="observation-meta">
                        <div class="observation-date">
                            <i class="far fa-calendar"></i>
                            ${obs.formattedDate}
                            <span style="margin-left: 10px;">
                                <i class="fas fa-tag"></i> ${getCategoryName(obs.category)}
                            </span>
                        </div>
                        <div>
                            <span class="observation-status status-${obs.status}" 
                                  onclick="updateStatus(${obs.id}, prompt('Nuevo estado:', '${obs.status}'))"
                                  title="Click para cambiar estado">
                                ${getStatusName(obs.status)}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Remover marca de nuevo despu√©s de renderizar
            setTimeout(() => {
                obsList.forEach(obs => {
                    obs.isNew = false;
                });
                saveObservations();
            }, 1000);
        }

        function formatObservationDetails(details) {
            let formatted = escapeHtml(details);
            formatted = formatted.replace(/^[‚Ä¢\-\*]\s*(.+)$/gm, '<li>$1</li>');
            
            if (formatted.includes('<li>')) {
                formatted = formatted.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            }
            
            formatted = formatted.replace(/\n/g, '<br>');
            return formatted;
        }

        function refreshData() {
            loadObservations();
            updateAll();
            filterObservations();
            showNotification('üîÑ Datos actualizados', 'success');
        }

        function updateLastUpdateTime() {
            const elapsed = Math.floor((Date.now() - lastUpdateTime) / 1000);
            let text;
            
            if (elapsed < 60) {
                text = `Actualizado hace ${elapsed} segundos`;
            } else if (elapsed < 3600) {
                const minutes = Math.floor(elapsed / 60);
                text = `Actualizado hace ${minutes} minuto${minutes !== 1 ? 's' : ''}`;
            } else {
                const hours = Math.floor(elapsed / 3600);
                text = `Actualizado hace ${hours} hora${hours !== 1 ? 's' : ''}`;
            }
            
            document.getElementById('last-update-time').textContent = text;
        }

        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configuraci√≥n del reporte
            const pageWidth = doc.internal.pageSize.getWidth();
            const margin = 20;
            let yPos = margin;
            
            // T√≠tulo
            doc.setFontSize(20);
            doc.setTextColor(26, 54, 93);
            doc.text('REPORTE DE OBSERVACIONES', pageWidth / 2, yPos, { align: 'center' });
            yPos += 15;
            
            // Fecha
            doc.setFontSize(11);
            doc.setTextColor(113, 128, 150);
            doc.text(`Generado: ${new Date().toLocaleDateString('es-ES')}`, pageWidth / 2, yPos, { align: 'center' });
            yPos += 20;
            
            // Estad√≠sticas
            doc.setFontSize(12);
            doc.setTextColor(45, 55, 72);
            doc.text('RESUMEN ESTAD√çSTICO', margin, yPos);
            yPos += 10;
            
            const stats = {
                total: observations.length,
                pending: observations.filter(o => o.status === 'pending').length,
                high: observations.filter(o => o.priority === 'high').length,
                documents: [...new Set(observations.map(o => o.document))].length
            };
            
            doc.setFontSize(10);
            doc.text(`‚Ä¢ Total observaciones: ${stats.total}`, margin, yPos);
            yPos += 7;
            doc.text(`‚Ä¢ Pendientes: ${stats.pending}`, margin, yPos);
            yPos += 7;
            doc.text(`‚Ä¢ Alta prioridad: ${stats.high}`, margin, yPos);
            yPos += 7;
            doc.text(`‚Ä¢ Documentos: ${stats.documents}`, margin, yPos);
            yPos += 15;
            
            // Observaciones
            observations.forEach((obs, index) => {
                if (index > 0 && yPos > 250) {
                    doc.addPage();
                    yPos = margin;
                }
                
                doc.setFontSize(14);
                doc.setTextColor(26, 54, 93);
                doc.text(`${index + 1}. ${obs.title}`, margin, yPos);
                yPos += 10;
                
                doc.setFontSize(11);
                doc.setTextColor(49, 130, 206);
                doc.text(`Documento: ${obs.document}`, margin, yPos);
                yPos += 7;
                
                doc.setFontSize(10);
                doc.setTextColor(45, 55, 72);
                
                const details = obs.details.split('\n');
                details.forEach(detail => {
                    const trimmed = detail.trim();
                    if (trimmed) {
                        if (yPos > 280) {
                            doc.addPage();
                            yPos = margin;
                        }
                        
                        if (trimmed.startsWith('‚Ä¢') || trimmed.startsWith('-') || trimmed.startsWith('*')) {
                            doc.text(`  ‚Ä¢ ${trimmed.substring(1).trim()}`, margin, yPos);
                        } else {
                            doc.text(`  ${trimmed}`, margin, yPos);
                        }
                        yPos += 5;
                    }
                });
                
                yPos += 5;
                
                if (obs.reference) {
                    doc.text(`Referencia: ${obs.reference}`, margin, yPos);
                    yPos += 6;
                }
                
                doc.setFontSize(9);
                doc.setTextColor(113, 128, 150);
                doc.text(`Fecha: ${new Date(obs.createdAt).toLocaleDateString('es-ES')} | Estado: ${getStatusName(obs.status)}`, margin, yPos);
                yPos += 10;
                
                if (index < observations.length - 1) {
                    doc.setDrawColor(200, 200, 200);
                    doc.line(margin, yPos, pageWidth - margin, yPos);
                    yPos += 10;
                }
            });
            
            // Footer
            doc.setFontSize(8);
            doc.setTextColor(113, 128, 150);
            doc.text(
                'Sistema Din√°mico de Correcciones y Observaciones',
                pageWidth / 2,
                doc.internal.pageSize.getHeight() - 10,
                { align: 'center' }
            );
            
            // Guardar
            doc.save(`reporte-observaciones-${new Date().toISOString().slice(0,10)}.pdf`);
            showNotification('üìÑ Reporte PDF generado', 'success');
        }

        function addExampleObservation() {
            const example = {
                id: Date.now(),
                document: "TISUR-1502-042-DWG-00001_B",
                title: "Correcci√≥n del N√öMERO DE PLANO PROVEEDOR",
                priority: "medium",
                status: "completed",
                details: "‚Ä¢ Se modific√≥ el numero de plano del proveedor\n‚Ä¢ De \"006CIV24-1502-042-DWG-00003\"\n‚Ä¢ A \"006CIV24-1502-042-DWG-00001\"",
                reference: "1",
                category: "plano",
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                formattedDate: formatDate(new Date()),
                isNew: false
            };
            
            observations.push(example);
            saveObservations();
        }

        function showNotification(message, type = 'success') {
            // Crear notificaci√≥n din√°mica
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 16px 24px;
                border-radius: 8px;
                background: white;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
                display: flex;
                align-items: center;
                gap: 12px;
                transform: translateX(150%);
                transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                z-index: 2000;
            `;
            
            const icon = document.createElement('div');
            icon.className = 'notification-icon';
            icon.innerHTML = '<i class="fas fa-check"></i>';
            
            const content = document.createElement('div');
            content.className = 'notification-content';
            content.innerHTML = `<h4>${type === 'success' ? '√âxito' : type === 'error' ? 'Error' : 'Info'}</h4><p>${message}</p>`;
            
            notification.appendChild(icon);
            notification.appendChild(content);
            document.body.appendChild(notification);
            
            // Mostrar
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            
            // Ocultar despu√©s de 3 segundos
            setTimeout(() => {
                notification.style.transform = 'translateX(150%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function scrollToForm() {
            document.getElementById('observation-form').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function formatDate(date) {
            return date.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function getCategoryName(category) {
            const categories = {
                'plano': 'Plano',
                'memoria': 'Memoria',
                'especificacion': 'Especificaci√≥n',
                'documentacion': 'Documentaci√≥n',
                'normativa': 'Normativa',
                'otros': 'Otros'
            };
            return categories[category] || category;
        }

        function getStatusName(status) {
            const statuses = {
                'pending': 'Pendiente',
                'in-progress': 'En Progreso',
                'completed': 'Completado',
                'cancelled': 'Cancelado'
            };
            return statuses[status] || status;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
